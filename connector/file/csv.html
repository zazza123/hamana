
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="index.html">
      
      
        <link rel="next" href="exceptions.html">
      
      
      <link rel="icon" href="../../config/images/hamana-lens.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>CSV - hamana</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
        <script src="https://unpkg.com/iframe-worker/shim"></script>
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../config/css/mkdocstrings.css">
    
      <link rel="stylesheet" href="../../config/css/nav.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="lime" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#csv" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../index.html" title="hamana" class="md-header__button md-logo" aria-label="hamana" data-md-component="logo">
      
  <img src="../../config/images/hamana-head.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            hamana
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              CSV
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="lime" data-md-color-accent="indigo"  aria-label="Switch to Dark Mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to Dark Mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.768 3.96zl-.002-.005a9 9 0 0 0-.218-.779c-.13-.394.21-.8.602-.67q.435.144.855.328l.01.005A10.002 10.002 0 0 1 12 22a10 10 0 0 1-9.162-5.985l-.004-.01a10 10 0 0 1-.329-.855c-.13-.392.277-.732.67-.602q.386.126.78.218l.004.002A9 9 0 0 0 14.999 6a9 9 0 0 0-.231-2.04M16.5 6c0 5.799-4.701 10.5-10.5 10.5q-.64 0-1.26-.075A8.5 8.5 0 1 0 16.425 4.74q.075.62.075 1.259Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="brown" data-md-color-accent="indigo"  aria-label="Switch to Light Mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to Light Mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 19a7 7 0 1 1 0-14 7 7 0 0 1 0 14m0-1.5a5.5 5.5 0 1 0 0-11 5.5 5.5 0 1 0 0 11m-5.657.157a.75.75 0 0 1 0 1.06l-1.768 1.768a.749.749 0 0 1-1.275-.326.75.75 0 0 1 .215-.734l1.767-1.768a.75.75 0 0 1 1.061 0M3.515 3.515a.75.75 0 0 1 1.06 0l1.768 1.768a.749.749 0 0 1-.326 1.275.75.75 0 0 1-.734-.215L3.515 4.575a.75.75 0 0 1 0-1.06M12 0a.75.75 0 0 1 .75.75v2.5a.75.75 0 0 1-1.5 0V.75A.75.75 0 0 1 12 0M4 12a.75.75 0 0 1-.75.75H.75a.75.75 0 0 1 0-1.5h2.5A.75.75 0 0 1 4 12m8 8a.75.75 0 0 1 .75.75v2.5a.75.75 0 0 1-1.5 0v-2.5A.75.75 0 0 1 12 20m12-8a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 1 0-1.5h2.5A.75.75 0 0 1 24 12m-6.343 5.657a.75.75 0 0 1 1.06 0l1.768 1.768a.75.75 0 0 1-.018 1.042.75.75 0 0 1-1.042.018l-1.768-1.767a.75.75 0 0 1 0-1.061m2.828-14.142a.75.75 0 0 1 0 1.06l-1.768 1.768a.75.75 0 0 1-1.042-.018.75.75 0 0 1-.018-1.042l1.767-1.768a.75.75 0 0 1 1.061 0"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/zazza123/hamana" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    zazza123/hamana
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../index.html" class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../usage.html" class="md-tabs__link">
        
  
  
    
  
  Usage

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../db/index.html" class="md-tabs__link">
          
  
  
    
  
  Connectors

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../core/query.html" class="md-tabs__link">
          
  
  
    
  
  Core

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../index.html" title="hamana" class="md-nav__button md-logo" aria-label="hamana" data-md-component="logo">
      
  <img src="../../config/images/hamana-head.png" alt="logo">

    </a>
    hamana
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/zazza123/hamana" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    zazza123/hamana
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Usage
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Connectors
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Connectors
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../db/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Database
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Database
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../db/hamana.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hamana
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../db/oracle.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Oracle
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../db/sqlite.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SQLite
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../db/teradata.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Teradata
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../db/exceptions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Exceptions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    File
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            File
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    CSV
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="csv.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    CSV
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <!-- Solution suggested in https://github.com/squidfunk/mkdocs-material/issues/4827 -->
<li class="md-nav__item">
    <a href="#hamana.connector.file.csv" class="md-nav__link">
        <span class="md-ellipsis">
            <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;csv
        </span>
    </a>

    <!-- Table of contents list -->
    
    <nav class="md-nav" aria-label=" csv">
        <ul class="md-nav__list">
            
             <!-- Solution suggested in https://github.com/squidfunk/mkdocs-material/issues/4827 -->
<li class="md-nav__item">
    <a href="#hamana.connector.file.csv.CSVConnector" class="md-nav__link">
        <span class="md-ellipsis">
            <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;CSVConnector
        </span>
    </a>

    <!-- Table of contents list -->
    
    <nav class="md-nav" aria-label=" CSVConnector">
        <ul class="md-nav__list">
            
             <!-- Solution suggested in https://github.com/squidfunk/mkdocs-material/issues/4827 -->
<li class="md-nav__item">
    <a href="#hamana.connector.file.csv.CSVConnector.dialect" class="md-nav__link">
        <span class="md-ellipsis">
            <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;dialect
        </span>
    </a>

    <!-- Table of contents list -->
    
</li>  
             <!-- Solution suggested in https://github.com/squidfunk/mkdocs-material/issues/4827 -->
<li class="md-nav__item">
    <a href="#hamana.connector.file.csv.CSVConnector.file_path" class="md-nav__link">
        <span class="md-ellipsis">
            <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;file_path
        </span>
    </a>

    <!-- Table of contents list -->
    
</li>  
             <!-- Solution suggested in https://github.com/squidfunk/mkdocs-material/issues/4827 -->
<li class="md-nav__item">
    <a href="#hamana.connector.file.csv.CSVConnector.encoding" class="md-nav__link">
        <span class="md-ellipsis">
            <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;encoding
        </span>
    </a>

    <!-- Table of contents list -->
    
</li>  
             <!-- Solution suggested in https://github.com/squidfunk/mkdocs-material/issues/4827 -->
<li class="md-nav__item">
    <a href="#hamana.connector.file.csv.CSVConnector.file_name" class="md-nav__link">
        <span class="md-ellipsis">
            <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;file_name
        </span>
    </a>

    <!-- Table of contents list -->
    
</li>  
             <!-- Solution suggested in https://github.com/squidfunk/mkdocs-material/issues/4827 -->
<li class="md-nav__item">
    <a href="#hamana.connector.file.csv.CSVConnector.has_header" class="md-nav__link">
        <span class="md-ellipsis">
            <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;has_header
        </span>
    </a>

    <!-- Table of contents list -->
    
</li>  
             <!-- Solution suggested in https://github.com/squidfunk/mkdocs-material/issues/4827 -->
<li class="md-nav__item">
    <a href="#hamana.connector.file.csv.CSVConnector.columns" class="md-nav__link">
        <span class="md-ellipsis">
            <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;columns
        </span>
    </a>

    <!-- Table of contents list -->
    
</li>  
             <!-- Solution suggested in https://github.com/squidfunk/mkdocs-material/issues/4827 -->
<li class="md-nav__item">
    <a href="#hamana.connector.file.csv.CSVConnector.execute" class="md-nav__link">
        <span class="md-ellipsis">
            <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;execute
        </span>
    </a>

    <!-- Table of contents list -->
    
</li>  
             <!-- Solution suggested in https://github.com/squidfunk/mkdocs-material/issues/4827 -->
<li class="md-nav__item">
    <a href="#hamana.connector.file.csv.CSVConnector.batch_execute" class="md-nav__link">
        <span class="md-ellipsis">
            <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;batch_execute
        </span>
    </a>

    <!-- Table of contents list -->
    
</li>  
             <!-- Solution suggested in https://github.com/squidfunk/mkdocs-material/issues/4827 -->
<li class="md-nav__item">
    <a href="#hamana.connector.file.csv.CSVConnector.to_sqlite" class="md-nav__link">
        <span class="md-ellipsis">
            <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;to_sqlite
        </span>
    </a>

    <!-- Table of contents list -->
    
</li>   </ul>
    </nav>
    
</li>   </ul>
    </nav>
    
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="exceptions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Exceptions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Core
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Core
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core/query.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Query
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core/column.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Column
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <!-- Solution suggested in https://github.com/squidfunk/mkdocs-material/issues/4827 -->
<li class="md-nav__item">
    <a href="#hamana.connector.file.csv" class="md-nav__link">
        <span class="md-ellipsis">
            <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;csv
        </span>
    </a>

    <!-- Table of contents list -->
    
    <nav class="md-nav" aria-label=" csv">
        <ul class="md-nav__list">
            
             <!-- Solution suggested in https://github.com/squidfunk/mkdocs-material/issues/4827 -->
<li class="md-nav__item">
    <a href="#hamana.connector.file.csv.CSVConnector" class="md-nav__link">
        <span class="md-ellipsis">
            <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;CSVConnector
        </span>
    </a>

    <!-- Table of contents list -->
    
    <nav class="md-nav" aria-label=" CSVConnector">
        <ul class="md-nav__list">
            
             <!-- Solution suggested in https://github.com/squidfunk/mkdocs-material/issues/4827 -->
<li class="md-nav__item">
    <a href="#hamana.connector.file.csv.CSVConnector.dialect" class="md-nav__link">
        <span class="md-ellipsis">
            <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;dialect
        </span>
    </a>

    <!-- Table of contents list -->
    
</li>  
             <!-- Solution suggested in https://github.com/squidfunk/mkdocs-material/issues/4827 -->
<li class="md-nav__item">
    <a href="#hamana.connector.file.csv.CSVConnector.file_path" class="md-nav__link">
        <span class="md-ellipsis">
            <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;file_path
        </span>
    </a>

    <!-- Table of contents list -->
    
</li>  
             <!-- Solution suggested in https://github.com/squidfunk/mkdocs-material/issues/4827 -->
<li class="md-nav__item">
    <a href="#hamana.connector.file.csv.CSVConnector.encoding" class="md-nav__link">
        <span class="md-ellipsis">
            <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;encoding
        </span>
    </a>

    <!-- Table of contents list -->
    
</li>  
             <!-- Solution suggested in https://github.com/squidfunk/mkdocs-material/issues/4827 -->
<li class="md-nav__item">
    <a href="#hamana.connector.file.csv.CSVConnector.file_name" class="md-nav__link">
        <span class="md-ellipsis">
            <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;file_name
        </span>
    </a>

    <!-- Table of contents list -->
    
</li>  
             <!-- Solution suggested in https://github.com/squidfunk/mkdocs-material/issues/4827 -->
<li class="md-nav__item">
    <a href="#hamana.connector.file.csv.CSVConnector.has_header" class="md-nav__link">
        <span class="md-ellipsis">
            <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;has_header
        </span>
    </a>

    <!-- Table of contents list -->
    
</li>  
             <!-- Solution suggested in https://github.com/squidfunk/mkdocs-material/issues/4827 -->
<li class="md-nav__item">
    <a href="#hamana.connector.file.csv.CSVConnector.columns" class="md-nav__link">
        <span class="md-ellipsis">
            <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;columns
        </span>
    </a>

    <!-- Table of contents list -->
    
</li>  
             <!-- Solution suggested in https://github.com/squidfunk/mkdocs-material/issues/4827 -->
<li class="md-nav__item">
    <a href="#hamana.connector.file.csv.CSVConnector.execute" class="md-nav__link">
        <span class="md-ellipsis">
            <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;execute
        </span>
    </a>

    <!-- Table of contents list -->
    
</li>  
             <!-- Solution suggested in https://github.com/squidfunk/mkdocs-material/issues/4827 -->
<li class="md-nav__item">
    <a href="#hamana.connector.file.csv.CSVConnector.batch_execute" class="md-nav__link">
        <span class="md-ellipsis">
            <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;batch_execute
        </span>
    </a>

    <!-- Table of contents list -->
    
</li>  
             <!-- Solution suggested in https://github.com/squidfunk/mkdocs-material/issues/4827 -->
<li class="md-nav__item">
    <a href="#hamana.connector.file.csv.CSVConnector.to_sqlite" class="md-nav__link">
        <span class="md-ellipsis">
            <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;to_sqlite
        </span>
    </a>

    <!-- Table of contents list -->
    
</li>   </ul>
    </nav>
    
</li>   </ul>
    </nav>
    
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="csv">CSV<a class="headerlink" href="#csv" title="Permanent link">&para;</a></h1>
<p>To "connect" to a CSV file, is possible to import the <code>CSVConnector</code> class from the <code>hamana.connector.file.csv</code> module.
As a shortcut, the <code>CSVConnector</code> class is also available in the <code>hamana.connector.file</code> module as <code>CSV</code>.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">hamana</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">hm</span>

<span class="c1"># connect</span>
<span class="n">customers_csv</span> <span class="o">=</span> <span class="n">hm</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">CSV</span><span class="p">(</span><span class="s2">&quot;customers.csv&quot;</span><span class="p">)</span>
<span class="n">customers</span> <span class="o">=</span> <span class="n">customers</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>

<span class="c1"># perform operations</span>
<span class="c1"># ...</span>
</code></pre></div>


<div class="doc doc-object doc-module">



<h2 id="hamana.connector.file.csv" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">hamana.connector.file.csv</span>


<a href="#hamana.connector.file.csv" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="hamana.connector.file.csv.CSVConnector" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">CSVConnector</span>


<a href="#hamana.connector.file.csv.CSVConnector" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">CSVConnector</span><span class="p">(</span>
    <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">dialect</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">csv</span><span class="o">.</span><span class="n">Dialect</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">has_header</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">columns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Column</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">getencoding</span><span class="p">(),</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


        <p>Class representing the connector to a CSV file.  </p>
<p>Observe that when the object is initialized, the class is not going
to read the CSV file; the class only performs checks on the file 
and extract metadata.</p>
<p>To process the CSV file, use the methods <code>execute()</code> or <code>to_sqlite()</code>.</p>
<p><strong>Example:</strong>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">hamana</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">hm</span>

<span class="n">csv_file</span> <span class="o">=</span> <span class="n">hm</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">CSV</span><span class="p">(</span><span class="s1">&#39;path/to/file.csv&#39;</span><span class="p">)</span>
<span class="n">query</span> <span class="o">=</span> <span class="n">csv_file</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</code></pre></div></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>file_path</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the CSV file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dialect</code>
            </td>
            <td>
                  <code><span title="type">type</span>[<span title="csv">csv</span>.<span title="csv.Dialect">Dialect</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dialect of the CSV file; the dialect is a class that defines 
the parameters for reading and writing CSV files, such as the 
delimiter, quotechar, and quoting. Commonly used dialects are:
    <code>csv.excel</code> (the dialect to use for CSV generated by Excel.), 
    <code>csv.excel_tab</code>(the dialect to use for tab-delimited files that are generated by Excel.), 
    <code>csv.unix_dialect</code> (the dialect to use for Unix-style CSV files.).
If <code>None</code>, the class will try to infer the dialect of the CSV 
file by using the <code>csv.Sniffer.sniff()</code> method.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>has_header</code>
            </td>
            <td>
                  <code><span title="bool">bool</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag to indicate if the CSV file has a header.<br />
If <code>None</code>, the class will try to infer it; observe 
that this method could lead to false positives.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>columns</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="            hamana.core.column.Column


  
      dataclass
  " href="../../core/column.html#hamana.core.column.Column">Column</a>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of columns in the CSV file. 
If columns are provided, ensure to list <strong>all</strong> the columns. 
By default, the class will try to infer the columns directly from 
the file. If the header is not available, then by default, the 
names of the columns will be <code>column_1</code>, <code>column_2</code>, and so on. 
The data type of the columns will be inferred automatically 
by taking a sample of 1000 rows from the file, converted into a 
DataFrame, and using the data types from the DataFrame.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>encoding</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Define the encoding to use during the reading process of the file.
By default, the class uses the system encoding retrieved by the <code>locale.getencoding()</code> method.</p>
              </div>
            </td>
            <td>
                  <code><span title="locale.getencoding">getencoding</span>()</code>
            </td>
          </tr>
      </tbody>
    </table>








                  <details class="quote">
                    <summary>Source code in <code>src/hamana/connector/file/csv.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">dialect</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">csv</span><span class="o">.</span><span class="n">Dialect</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">has_header</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">columns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Column</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">getencoding</span><span class="p">()</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;start&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">file_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;file_path: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;encoding: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># check file existance</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="n">error_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;File not found: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>

    <span class="c1"># set file name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="o">.</span><span class="n">name</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;file_name: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># set dialect</span>
    <span class="n">infer_dialect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_infer_dialect</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">dialect</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;dialect is not provided, trying to infer..&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dialect</span> <span class="o">=</span> <span class="n">infer_dialect</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># compare dialect with inferred dialect</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_compare_dialects</span><span class="p">(</span><span class="n">dialect</span><span class="p">,</span> <span class="n">infer_dialect</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dialect</span> <span class="o">=</span> <span class="n">dialect</span>

    <span class="c1"># set has_header</span>
    <span class="k">if</span> <span class="n">has_header</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;has_header is not provided, trying to infer..&quot;</span><span class="p">)</span>
        <span class="n">has_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_has_header</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">has_header</span> <span class="o">=</span> <span class="n">has_header</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;has_header: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">has_header</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># set columns</span>
    <span class="n">infer_columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_infer_columns</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_columns</span><span class="p">(</span><span class="n">infer_columns</span><span class="p">,</span> <span class="n">columns</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;columns: </span><span class="si">{</span><span class="p">[</span><span class="n">column</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">column</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;end&quot;</span><span class="p">)</span>
    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="hamana.connector.file.csv.CSVConnector.dialect" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">dialect</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#hamana.connector.file.csv.CSVConnector.dialect" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">dialect</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">csv</span><span class="o">.</span><span class="n">Dialect</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Dialect of the CSV file.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="hamana.connector.file.csv.CSVConnector.file_path" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">file_path</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#hamana.connector.file.csv.CSVConnector.file_path" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">file_path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Path and name of the CSV file.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="hamana.connector.file.csv.CSVConnector.encoding" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">encoding</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#hamana.connector.file.csv.CSVConnector.encoding" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">encoding</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">encoding</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Encoding to use during the reading process of the file.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="hamana.connector.file.csv.CSVConnector.file_name" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">file_name</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#hamana.connector.file.csv.CSVConnector.file_name" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">file_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="o">.</span><span class="n">name</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Name of the CSV file.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="hamana.connector.file.csv.CSVConnector.has_header" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">has_header</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#hamana.connector.file.csv.CSVConnector.has_header" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">has_header</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">has_header</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Flag to indicate if the CSV file has a header.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="hamana.connector.file.csv.CSVConnector.columns" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">columns</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#hamana.connector.file.csv.CSVConnector.columns" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">columns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Column</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_columns</span><span class="p">(</span>
    <span class="n">infer_columns</span><span class="p">,</span> <span class="n">columns</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>List of columns in the CSV file.</p>

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="hamana.connector.file.csv.CSVConnector.execute" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">execute</span>


<a href="#hamana.connector.file.csv.CSVConnector.execute" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">execute</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Query</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Function used to extract data from the CSV file.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            hamana.connector.db.query.Query" href="../../core/query.html#hamana.connector.db.query.Query">Query</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function automatically creates a <code>Query</code> object, 
executes the extraction and returns the object created
with the resulting rows.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/hamana/connector/file/csv.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Query</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function used to extract data from the CSV file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The function automatically creates a `Query` object, </span>
<span class="sd">                executes the extraction and returns the object created</span>
<span class="sd">                with the resulting rows.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;start&quot;</span><span class="p">)</span>

    <span class="c1"># set query</span>
    <span class="n">query</span> <span class="o">=</span> <span class="n">Query</span><span class="p">(</span>
        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT * FROM &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">,</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span>
    <span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;query created: </span><span class="si">{</span><span class="n">query</span><span class="o">.</span><span class="n">query</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># read CSV file</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;reading CSV file&quot;</span><span class="p">)</span>
    <span class="n">df_result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
        <span class="n">filepath_or_buffer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="p">,</span>
        <span class="n">dialect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dialect</span><span class="p">,</span> <span class="c1"># type: ignore</span>
        <span class="n">header</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_header</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">column</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">],</span>
        <span class="n">encoding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">,</span>
        <span class="n">dtype</span> <span class="o">=</span> <span class="s2">&quot;object&quot;</span>
    <span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;data extracted, rows: </span><span class="si">{</span><span class="n">df_result</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, columns: </span><span class="si">{</span><span class="n">df_result</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># adjust columns</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;adjusting columns and data types&quot;</span><span class="p">)</span>
    <span class="n">df_result</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">adjust_df</span><span class="p">(</span><span class="n">df_result</span><span class="p">)</span>

    <span class="c1"># set result</span>
    <span class="n">query</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="n">df_result</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;end&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">query</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="hamana.connector.file.csv.CSVConnector.batch_execute" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">batch_execute</span>


<a href="#hamana.connector.file.csv.CSVConnector.batch_execute" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">batch_execute</span><span class="p">(</span>
    <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Function used to extract data from the CSV file and return the results in batches. 
This approach is used to avoid memory issues when dealing with large datasets.</p>
<p>Observe that the returned data are not adjusted in terms of data types, but 
provided as raw data.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>batch_size</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>size of the batch to return.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Generator used to return the results in batches.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/hamana/connector/file/csv.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">batch_execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function used to extract data from the CSV file and return the results in batches. </span>
<span class="sd">        This approach is used to avoid memory issues when dealing with large datasets.</span>

<span class="sd">        Observe that the returned data are not adjusted in terms of data types, but </span>
<span class="sd">        provided as raw data.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            batch_size: size of the batch to return.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Generator used to return the results in batches.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;start&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;batch size: </span><span class="si">{</span><span class="n">batch_size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># open file</span>
    <span class="n">dt_start</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;open file </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">newline</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">encoding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">dialect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dialect</span><span class="p">)</span>

        <span class="c1"># skip header</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_header</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;header skipped&quot;</span><span class="p">)</span>
            <span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">)</span>

        <span class="c1"># read rows</span>
        <span class="n">batch</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">row_count</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">batch_count</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">reader</span><span class="p">:</span>
                <span class="n">batch</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                <span class="n">row_count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span> <span class="o">==</span> <span class="n">batch_size</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">batch_count</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;batch </span><span class="si">{</span><span class="n">batch_count</span><span class="si">}</span><span class="s2"> read&quot;</span><span class="p">)</span>
                    <span class="k">yield</span> <span class="n">batch</span>

                    <span class="c1"># reset batch</span>
                    <span class="n">batch</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">batch_count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">except</span> <span class="ne">UnicodeDecodeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">err_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ERROR: parsing </span><span class="si">{</span><span class="n">row_count</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2"> row.&quot;</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">CSVDecodeRowError</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>

        <span class="c1"># yield remaining rows</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">batch</span>

    <span class="n">dt_end</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;file read, elapsed time: </span><span class="si">{</span><span class="n">dt_end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">dt_start</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">row_count</span><span class="si">}</span><span class="s2"> rows processed (</span><span class="si">{</span><span class="n">batch_count</span><span class="si">}</span><span class="s2"> batches)&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;end&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="hamana.connector.file.csv.CSVConnector.to_sqlite" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">to_sqlite</span>


<a href="#hamana.connector.file.csv.CSVConnector.to_sqlite" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">to_sqlite</span><span class="p">(</span>
    <span class="n">table_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">raw_insert</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span>
    <span class="n">mode</span><span class="p">:</span> <span class="n">SQLiteDataImportMode</span> <span class="o">=</span> <span class="n">SQLiteDataImportMode</span><span class="o">.</span><span class="n">REPLACE</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>This function is used to extract data from the CSV file and 
insert it into the <code>hamana</code> internal database (<code>HamanaConnector</code>).</p>
<p>The <code>hamana</code> db is a SQLite database, for this reason 
<code>bool</code>, <code>datetime</code> and <code>timestamp</code> data types are not supported.
If some of the columns are defined with these data types, 
then the method could perform an automatic conversion to 
a SQLite data type.</p>
<p>The conversions are:</p>
<ul>
<li><code>bool</code> columns are mapped to <code>INTEGER</code> data type, with the values 
    <code>True</code> and <code>False</code> converted to <code>1</code> and <code>0</code>.</li>
<li><code>datetime</code> columns are mapped to <code>REAL</code> data type, with the values 
    converted to a float number using the following format: <code>YYYYMMDD.HHmmss</code>.
    Observe that the integer part represents the date in the format <code>YYYYMMDD</code>,
    while the decimal part represents the time component in the format <code>HHmmss</code>.</li>
</ul>
<p>By default, the method performs the automatic datatype 
conversion. However, use the parameter <code>raw_insert</code> to 
<strong>avoid</strong> this conversion and improve the INSERT efficiency. </p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>name of the table to insert the data.
By assumption, the table's name is converted to uppercase.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>raw_insert</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>bool value to disable/activate the datatype 
conversion during the INSERT process. By default, it is 
set to <code>False</code>.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>batch_size</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>size of the batch used during the inserting process.</p>
              </div>
            </td>
            <td>
                  <code>10000</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mode</code>
            </td>
            <td>
                  <code><span title="hamana.connector.db.schema.SQLiteDataImportMode">SQLiteDataImportMode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>mode of importing the data into the database.</p>
              </div>
            </td>
            <td>
                  <code><span title="hamana.connector.db.schema.SQLiteDataImportMode">SQLiteDataImportMode</span>.<span title="hamana.connector.db.schema.SQLiteDataImportMode.REPLACE">REPLACE</span></code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/hamana/connector/file/csv.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_sqlite</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">table_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">raw_insert</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10_000</span><span class="p">,</span>
    <span class="n">mode</span><span class="p">:</span> <span class="n">SQLiteDataImportMode</span> <span class="o">=</span> <span class="n">SQLiteDataImportMode</span><span class="o">.</span><span class="n">REPLACE</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function is used to extract data from the CSV file and </span>
<span class="sd">        insert it into the `hamana` internal database (`HamanaConnector`).</span>

<span class="sd">        The `hamana` db is a SQLite database, for this reason </span>
<span class="sd">        `bool`, `datetime` and `timestamp` data types are not supported.</span>
<span class="sd">        If some of the columns are defined with these data types, </span>
<span class="sd">        then the method could perform an automatic conversion to </span>
<span class="sd">        a SQLite data type.</span>

<span class="sd">        The conversions are:</span>

<span class="sd">        - `bool` columns are mapped to `INTEGER` data type, with the values </span>
<span class="sd">            `True` and `False` converted to `1` and `0`.</span>
<span class="sd">        - `datetime` columns are mapped to `REAL` data type, with the values </span>
<span class="sd">            converted to a float number using the following format: `YYYYMMDD.HHmmss`.</span>
<span class="sd">            Observe that the integer part represents the date in the format `YYYYMMDD`,</span>
<span class="sd">            while the decimal part represents the time component in the format `HHmmss`.</span>

<span class="sd">        By default, the method performs the automatic datatype </span>
<span class="sd">        conversion. However, use the parameter `raw_insert` to </span>
<span class="sd">        **avoid** this conversion and improve the INSERT efficiency. </span>

<span class="sd">        Parameters:</span>
<span class="sd">            table_name: name of the table to insert the data.</span>
<span class="sd">                By assumption, the table&#39;s name is converted to uppercase.</span>
<span class="sd">            raw_insert: bool value to disable/activate the datatype </span>
<span class="sd">                conversion during the INSERT process. By default, it is </span>
<span class="sd">                set to `False`.</span>
<span class="sd">            batch_size: size of the batch used during the inserting process.</span>
<span class="sd">            mode: mode of importing the data into the database.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;start&quot;</span><span class="p">)</span>

    <span class="n">table_name_upper</span> <span class="o">=</span> <span class="n">table_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="n">insert_query</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">column_names</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">query</span> <span class="o">=</span> <span class="n">Query</span><span class="p">(</span>
        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT * FROM &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">,</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span>
    <span class="p">)</span>

    <span class="c1"># import internal database</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">..db.hamana</span><span class="w"> </span><span class="kn">import</span> <span class="n">HamanaConnector</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;imported internal database&quot;</span><span class="p">)</span>

    <span class="c1"># get instance</span>
    <span class="n">hamana_db</span> <span class="o">=</span> <span class="n">HamanaConnector</span><span class="o">.</span><span class="n">get_instance</span><span class="p">()</span>
    <span class="n">hamana_connection</span> <span class="o">=</span> <span class="n">hamana_db</span><span class="o">.</span><span class="n">get_connection</span><span class="p">()</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;internal database instance obtained&quot;</span><span class="p">)</span>

    <span class="c1"># check table existance</span>
    <span class="n">query_check_table</span> <span class="o">=</span> <span class="n">Query</span><span class="p">(</span>
        <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;SELECT COUNT(1) AS flag_exists FROM sqlite_master WHERE type = &#39;table&#39; AND name = :table_name&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;table_name&quot;</span><span class="p">:</span> <span class="n">table_name_upper</span><span class="p">},</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">BooleanColumn</span><span class="p">(</span><span class="n">order</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;flag_exists&quot;</span><span class="p">,</span> <span class="n">true_value</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">false_value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="n">hamana_db</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query_check_table</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;table check query executed&quot;</span><span class="p">)</span>

    <span class="n">flag_table_exists</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">query_check_table</span><span class="o">.</span><span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">flag_table_exists</span> <span class="o">=</span> <span class="n">query_check_table</span><span class="o">.</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;flag_exists&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;table exists: </span><span class="si">{</span><span class="n">flag_table_exists</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># block insert if mode is fail and table exists</span>
    <span class="k">if</span> <span class="n">flag_table_exists</span> <span class="ow">and</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">SQLiteDataImportMode</span><span class="o">.</span><span class="n">FAIL</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;table </span><span class="si">{</span><span class="n">table_name_upper</span><span class="si">}</span><span class="s2"> already exists&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">TableAlreadyExists</span><span class="p">(</span><span class="n">table_name_upper</span><span class="p">)</span>

    <span class="c1"># execute extraction</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;extracting data, batch size: </span><span class="si">{</span><span class="n">batch_size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">flag_first_batch</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">hamana_cursor</span> <span class="o">=</span> <span class="n">hamana_connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">raw_batch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_execute</span><span class="p">(</span><span class="n">batch_size</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">flag_first_batch</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;generating insert query&quot;</span><span class="p">)</span>
            <span class="n">insert_query</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">get_insert_query</span><span class="p">(</span><span class="n">table_name_upper</span><span class="p">)</span>
            <span class="n">column_names</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">get_column_names</span><span class="p">()</span>

            <span class="c1"># create table</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">flag_table_exists</span> <span class="ow">or</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">SQLiteDataImportMode</span><span class="o">.</span><span class="n">REPLACE</span><span class="p">:</span>

                <span class="c1"># drop if exists (for replace)</span>
                <span class="k">if</span> <span class="n">flag_table_exists</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;drop table </span><span class="si">{</span><span class="n">table_name_upper</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">hamana_cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;DROP TABLE </span><span class="si">{</span><span class="n">table_name_upper</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">hamana_connection</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;table dropped&quot;</span><span class="p">)</span>

                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;creating table </span><span class="si">{</span><span class="n">table_name_upper</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">hamana_cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">get_create_query</span><span class="p">(</span><span class="n">table_name_upper</span><span class="p">))</span>
                <span class="n">hamana_connection</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;table created&quot;</span><span class="p">)</span>

            <span class="c1"># set flag</span>
            <span class="n">flag_first_batch</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># adjust data types</span>
        <span class="k">if</span> <span class="n">raw_insert</span><span class="p">:</span>
            <span class="c1"># no data type conversion</span>
            <span class="n">hamana_cursor</span><span class="o">.</span><span class="n">executemany</span><span class="p">(</span><span class="n">insert_query</span><span class="p">,</span> <span class="n">raw_batch</span><span class="p">)</span>
            <span class="n">hamana_connection</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># create temporary query</span>
            <span class="n">query_temp</span> <span class="o">=</span> <span class="n">Query</span><span class="p">(</span><span class="n">query</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">query</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

            <span class="c1"># assign result (adjust data types)</span>
            <span class="n">df_temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">raw_batch</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">column_names</span><span class="p">)</span>
            <span class="n">df_temp</span> <span class="o">=</span> <span class="n">query_temp</span><span class="o">.</span><span class="n">adjust_df</span><span class="p">(</span><span class="n">df_temp</span><span class="p">)</span>
            <span class="n">query_temp</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="n">df_temp</span>

            <span class="c1"># insert into table</span>
            <span class="n">query_temp</span><span class="o">.</span><span class="n">to_sqlite</span><span class="p">(</span><span class="n">table_name_upper</span><span class="p">,</span> <span class="n">SQLiteDataImportMode</span><span class="o">.</span><span class="n">APPEND</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;data inserted into table </span><span class="si">{</span><span class="n">table_name_upper</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">hamana_cursor</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;end&quot;</span><span class="p">)</span>
    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="index.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: File Connectors">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                File Connectors
              </div>
            </div>
          </a>
        
        
          
          <a href="exceptions.html" class="md-footer__link md-footer__link--next" aria-label="Next: Exceptions">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Exceptions
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
    <a href="https://www.instagram.com/gaiaparte/" target="_blank" rel="noopener" title="Illustrations by" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M224.3 141a115 115 0 1 0-.6 230 115 115 0 1 0 .6-230m-.6 40.4a74.6 74.6 0 1 1 .6 149.2 74.6 74.6 0 1 1-.6-149.2m93.4-45.1a26.8 26.8 0 1 1 53.6 0 26.8 26.8 0 1 1-53.6 0m129.7 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8M399 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.instant.progress", "navigation.tabs", "navigation.top", "navigation.indexes", "navigation.footer", "toc.follow", "search.suggest", "content.code.copy"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
    
  </body>
</html>